"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[86293],{86293:(e,t,i)=>{i.d(t,{Z:()=>M});var n=i(91931),o=i(40606),d=i(31913),a=i(91086),l=i(33259),r=i(34217),s=i(74820),c=i(66880),m=i(21213),u=i(44917),w=i(36151),T=i(25174),p=i(33990);const h=(0,n.zo)("div",{padding:"16px 0"}),f=(0,n.zo)("button",(e=>{let{$theme:t,$isSelected:i,$isDisabled:n}=e;return{width:"128px",padding:"16px",border:`2px solid ${i?t.colors.borderSelected:t.colors.borderOpaque}`,borderRadius:"12px",display:"flex",flexDirection:"column",...n?{cursor:"not-allowed"}:{}}})),Z=(0,n.zo)("div",(e=>{let{$theme:t}=e;return{position:"sticky",top:"64px",backgroundColor:t.colors.backgroundPrimary}})),g=e=>{const{dates:t,selectedDateInfo:i,onDateChange:n}=e,o=(0,w.useRef)(null);return(0,w.useEffect)((()=>{o&&o.current&&o.current.scrollIntoView({behavior:"auto",inline:"center"})}),[o]),(0,p.tZ)(Z,{children:(0,p.tZ)(h,{children:(0,p.tZ)(T.ZP,{items:t,renderItem:e=>{let{item:t}=e;return(0,p.BX)(f,{"data-testid":"date-schedule-selector-button",ref:t.date===i.date?o:null,disabled:"DISABLED"===t.viewState,onClick:()=>n(t),$isSelected:t.date===i.date,$isDisabled:"DISABLED"===t.viewState,children:[t.text?(0,p.tZ)(d.ZP,{text:t.text}):null,t.secondaryText?(0,p.tZ)(d.ZP,{text:t.secondaryText}):null]})},renderForwardButton:e=>(0,p.tZ)(T.O0,{onButtonClick:e,direction:T.mQ.FORWARD}),renderBackButton:e=>(0,p.tZ)(T.O0,{onButtonClick:e,direction:T.mQ.BACK}),spacerWidth:8,arrowScrollAmount:400})})})},y=(0,n.zo)("div",{paddingTop:"64px"}),W=(0,n.zo)("span",(e=>{let{$theme:t}=e;return{...t.typography.HeadingSmall,marginBottom:"16px"}})),b=(0,n.zo)("p",(e=>{let{$theme:t}=e;return{...t.typography.ParagraphSmall,color:t.colors.contentTertiary}})),M=e=>{const{entryPoint:t,initialSelectedTimeOption:i,onTimeOptionSelected:n,onBack:w,onClose:T,onSchedule:h,onAsap:f,headerButtonType:Z,title:M,stickyTitle:x,subtitle:S}=e,{timeWindowPicker:k,selectedDate:C,selectedTimeRange:v,onDateChange:P,onTimeRangeChange:D,onTimeFinalized:V,onTimeAsap:L}=(0,c.Z)({entryPoint:t,initialSelectedTimeOption:i,onTimeOptionSelected:n});return(0,p.tZ)(o.Z,{source:k,loaded:e=>{const t=e?.headerText,i=e?.secondaryText,n=e?.dates,o=e?.actions,c=n&&n.find((e=>e.date===C));return(0,p.BX)(p.HY,{children:[(0,p.tZ)(a.xB,{title:x||t?.accessibilityText,floatingMode:a.rY.floating,leftButton:"back"===Z?(0,p.tZ)(l.ay,{onClick:w}):(0,p.tZ)(l.hQ,{onClick:T})}),(0,p.tZ)(r.f,{$removeMarginTop:!0,children:(0,p.BX)(y,{children:[M?(0,p.tZ)(s.r,{children:(0,p.tZ)(W,{children:M})}):t?(0,p.tZ)(s.r,{children:(0,p.tZ)(d.ZP,{text:t})}):null,S?(0,p.tZ)(b,{children:S}):i?(0,p.tZ)(d.ZP,{text:i}):null,n?(0,p.tZ)(g,{dates:n,selectedDateInfo:c||n?.[0]||{},onDateChange:P}):null,c?.listItems?(0,p.tZ)(u.Z,{listItems:c.listItems,selectedDate:C,selectedTimeRange:v,onTimeRangeChange:D}):null]})}),o?(0,p.tZ)(m.Z,{actions:o,selectedDate:C,selectedTimeRange:v,onClose:T,onSchedule:h,onTimeFinalized:V,onAsap:f,onTimeAsap:L}):null]})},error:()=>(0,p.tZ)(p.HY,{}),loading:()=>(0,p.tZ)(p.HY,{})})}},21213:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(70589),o=i(47073),d=i(52298),a=i(33990);const l=e=>{const{actions:t,selectedDate:i,selectedTimeRange:l,onClose:r,onSchedule:s,onTimeFinalized:c,onAsap:m,onTimeAsap:u}=e;return(0,a.tZ)(n.m,{children:t.map(((e,n)=>"buttonViewModel"===e.viewModel?.type?(0,a.BX)("div",{"data-testid":"schedule-modal-button",children:[(0,a.tZ)(o.Z,{isDisabled:!("TIME_WINDOW_SELECTED"!==e.availability||i&&l),onClick:()=>(e=>{if(e)switch(e.type){case"SCHEDULE":s(),c();break;case"ASAP":m(),u();break;case"CANCEL":r()}})(e.action),viewModel:{...e.viewModel.buttonViewModel,isEnabled:void 0}}),n===t.length-1?null:(0,a.tZ)(d.ZP,{$height:8})]},e.action?.type):null))})}},44917:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(36151),o=i(91931),d=i(68561),a=i(61089),l=i(31913),r=i(33990);const s=(0,o.zo)("div",{display:"flex",justifyContent:"space-between"}),c=(0,o.zo)("div",{display:"flex",flexDirection:"column",justifyContent:"center"}),m=(0,o.zo)("div",{padding:"24px 16px 8px"}),u=e=>{const{listItems:t,selectedDate:i,selectedTimeRange:o,onTimeRangeChange:u}=e,w=(0,n.useRef)(null);return(0,n.useEffect)((()=>{w&&w.current&&w.current.scrollIntoView({behavior:"auto",block:"center"})}),[w]),(0,r.tZ)(d.Z,{value:JSON.stringify(o),onChange:e=>u(e),name:"time-picker-options",labelPlacement:"left",children:t.filter((e=>"timeWindowViewModel"!==e.type||e.timeWindowViewModel.timeWindow?.date===i)).map((e=>{switch(e.type){case"timeWindowViewModel":{const t=e.timeWindowViewModel.text,n=e.timeWindowViewModel.secondaryText,d=e.timeWindowViewModel.tertiaryText,m=e.timeWindowViewModel.timeWindow?.startTime,u=e.timeWindowViewModel.timeWindow?.startTimeSeconds,T=e.timeWindowViewModel.timeWindow?.endTime,p=JSON.stringify({startTime:m,startTimeMs:"number"==typeof u?1e3*u:void 0,endTime:T});return(0,r.tZ)(a.Y8,{disabled:"DISABLED"===e.timeWindowViewModel.viewState,overrides:{Root:{style:e=>{let{$theme:t}=e;return{marginTop:0,marginBottom:0,padding:"24px 16px",width:"100%",boxSizing:"border-box",display:"flex",justifyContent:"space-between",borderBottom:`1px solid ${t.colors.borderOpaque}`}}},Label:{style:()=>({flexGrow:1})}},value:p,children:(0,r.BX)(s,{"data-testid":"delivery-time-radio",ref:o?.startTime===m&&o?.endTime===T?w:null,children:[(0,r.BX)(c,{children:[t?(0,r.tZ)(l.ZP,{text:t}):null,n?(0,r.tZ)(l.ZP,{text:n}):null]}),(0,r.tZ)(c,{children:d?(0,r.tZ)(l.ZP,{text:d}):null})]})},`${i}-${m}-${T}`)}case"labelViewModel":{const t=e.labelViewModel.text;return t?(0,r.tZ)(m,{children:(0,r.tZ)(l.ZP,{text:t})}):null}}return""}))})}},66880:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(36151),o=i(41639),d=i(58984),a=i(8057),l=i(50862);function r(e){let{entryPoint:t,initialSelectedTimeOption:i,onTimeOptionSelected:r}=e;const s=(0,d.I0)(),[c,m]=(0,n.useState)(),[u,w]=(0,n.useState)(),T=(0,n.useCallback)((e=>{const t=function(e,t){const i="date"in e?e.date:null,n=t.dates?.find((e=>e.date===i));if(i&&n?.listItems)return i;const o=t.dates?.find((e=>"PRIMARY"===e.viewState));return o?o.date:null}(i,e);m(t),w(function(e,t,i,n){if("date"in t&&e===t.date&&n){const e=n.find((e=>{if("timeWindowViewModel"===e.type){const i=e.timeWindowViewModel.timeWindow;return i?.startTime===t.startTime&&i?.endTime===t.endTime}}));if("timeWindowViewModel"===e?.type){const t=e.timeWindowViewModel?.timeWindow;return{startTime:t?.startTime||0,startTimeMs:"number"==typeof t?.startTimeSeconds?1e3*t.startTimeSeconds:void 0,endTime:t?.endTime||0}}}else if(i&&n){const e=n.find((e=>{if("timeWindowViewModel"===e.type)return e.timeWindowViewModel.timeWindow?.timeWindowID===i}));if("timeWindowViewModel"===e?.type){const t=e.timeWindowViewModel?.timeWindow;return{startTime:t?.startTime||0,startTimeMs:"number"==typeof t?.startTimeSeconds?1e3*t.startTimeSeconds:void 0,endTime:t?.endTime||0}}}return null}(t,i,e.selectedTimeWindowID,e.dates?.find((e=>e.date===t))?.listItems))}),[m,w,i]),{timeWindowPicker:p}=(0,l.Z)({entryPoint:t,initializeTimeWindowPicker:T});return{timeWindowPicker:p,selectedDate:c,selectedTimeRange:u,onDateChange:e=>{if(m(e.date),u){const t=e.listItems?.find((e=>{if("timeWindowViewModel"===e.type){const t=e.timeWindowViewModel.timeWindow;return t?.startTime===u.startTime&&t?.endTime===u.endTime}}));if(t&&"timeWindowViewModel"===t.type){const e=t.timeWindowViewModel.timeWindow?.startTime??0,i=t.timeWindowViewModel.timeWindow?.startTimeSeconds??0,n=t.timeWindowViewModel.timeWindow?.endTime??0;w({startTime:e,startTimeMs:1e3*i,endTime:n})}else w(null)}},onTimeRangeChange:e=>{try{const{startTime:t,startTimeMs:i,endTime:n}=JSON.parse(e.target.value);w({startTime:t,startTimeMs:i,endTime:n})}catch(e){}},onTimeFinalized:()=>{if(c&&u){const e={scheduled:!0,date:c,startTime:u.startTime,startTimeMs:u.startTimeMs,endTime:u.endTime};(0,o.O)(i,e)||s((0,a.hW)()),r(e)}},onTimeAsap:()=>{"asap"in i||s((0,a.hW)()),r({asap:!0})}}}},50862:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(36151),o=i(64388),d=i(54176),a=i(21304);function l(e){let{entryPoint:t,initializeTimeWindowPicker:i,forceLoadCheckoutPresentation:l}=e;const r=(0,n.useRef)(l??!1),[s,c]=(0,n.useState)({data:null,error:null,hasLoaded:!1,isLoading:!1}),m="CHECKOUT"===t.type,u="STORE"===t.type,w="FEED"===t.type,{feed:T,shouldGetFeed:p,getFeed:h}=(0,d.Z)(),f=T.data?.timeWindowPicker,{store:Z,shouldGetStore:g,getStore:y}=(0,o.ZP)("FEED"!==t.type?t.storeUuid:void 0),W=Z.data?.timeWindowPicker,b=(0,a.CF)(),M=b.data?.checkoutPayloads?.timeWindowPicker?.timeWindowPickerViewModel,x=(0,n.useCallback)((e=>{c({data:e,hasLoaded:!0,isLoading:!1,error:null}),i&&i(e)}),[c,i]),S=(0,n.useCallback)((()=>{c({data:null,hasLoaded:!0,isLoading:!1,error:null})}),[c]),k=(0,n.useCallback)((()=>{c({data:null,hasLoaded:!1,isLoading:!0,error:null})}),[c]);return(0,n.useEffect)((()=>{w&&p&&h()}),[w,p,h]),(0,n.useEffect)((()=>{u&&g&&y()}),[u,g,y]),(0,n.useEffect)((()=>{m&&r.current&&r.current&&(r.current=!1)}),[m,r]),(0,n.useEffect)((()=>{b.hasLoaded&&m?M?x(M):Z.hasLoaded&&W?x(W):S():Z.hasLoaded&&u?W?x(W):S():T.hasLoaded&&w?f?x(f):S():(b.isLoading||Z.isLoading||T.isLoading)&&k()}),[x,S,k,b.hasLoaded,b.isLoading,Z.hasLoaded,Z.isLoading,T.hasLoaded,T.isLoading,m,u,w,M,W,f]),{timeWindowPicker:s}}}}]);