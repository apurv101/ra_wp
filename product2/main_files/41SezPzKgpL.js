'use strict';mix_d("VSEDistributionCards__vse-vw-dp-card:vse-vw-dp-card__w5IPRhgV","exports tslib @p/A @c/scoped-dom @c/weblabs @c/metrics @c/logger @p/a-modal @c/aui-untrusted-ajax @c/navigation @c/aui-carousel @c/browser-window".split(" "),function(sa,A,Qa,Ra,Sa,X,Ta,Ua,Va,Wa,Xa,Ya){function x(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}var c=x(Qa),E=x(Ra),Za=x(Sa),$a=x(Ta),ab=x(Ua),bb=x(Va),ta=x(Wa),cb=x(Xa),B=x(Ya),ua,v=function(a){var b=ua;Object.keys(a).length<b.requiredNumOfFields&&
X.count("invalidNumOfFields-"+b.producerId,1);a=JSON.stringify(a).replace(/\\\\/g,"");X.event(JSON.parse(a),b.producerId,b.schemaId,{ssd:!1})},db=function(a){return function(b){return c["default"].$.extend({eventSource:a.eventSource,placementContext:a.placementContext,clientId:a.clientId,timestamp:new Date,userAgentData:navigator.userAgent,titleSessionId:"0",videoAsin:"",videoAsinList:a.videoAsinList||"",rankingStrategy:a.rankingStrategy||"",creativeId:a.creativeId,stringPayload:a.stringPayload||
""},b)}},eb=function(){return function(a,b,e){var h=this;this.onIntersectionObserved=function(g){g.forEach(function(k){k.isIntersecting&&(k=h.childElems.indexOf(k.target),h.callback(k))})};void 0===a&&(a=null);this.callback=e;this.childElems=Array.from(document.querySelectorAll(b)).filter(function(g){return null!==g.offsetParent});this.optionsForIntersection={root:a,rootMargin:"0px",threshold:.5};this.intersectionObserver=new IntersectionObserver(this.onIntersectionObserved,this.optionsForIntersection);
this.childElems.forEach(function(g){h.intersectionObserver.observe(g)})}}(),da=function(a,b,e,h,g){void 0===g&&(g=3);g--;bb["default"].post(a,{accepts:"*/*",contentType:"application/json;charset=UTF-8",timeout:1E4},b).then(function(k){e(k)}).catch(function(k){0<g?da(a,b,e,h,g):(0===k.statusCode&&r("Request has failed with unknown status code. Payload: "+JSON.stringify(b),"ERROR"),h(k))})},d={pageType:"",clientPrefix:"",deviceType:"",placement:"",metricsPlacement:"",cardId:"",creativeId:"",requester:"",
buildCsmPayload:function(a){},clientName:"",isIvxOpen:!1},q=function(a,b){void 0===b&&(b=1);try{X.count("vse:csm:cards:"+d.clientPrefix+":"+a,b)}catch(e){r("failed to post CSM metric","ERROR")}},F=function(a,b){void 0===b&&(b=1);q(a+":"+d.deviceType,b)},r=function(a,b){$a["default"].log("VSEWidgetCards: "+a+". Client prefix: "+d.clientPrefix+", Page type: "+d.pageType,b,"VSEDistributionCards")},va=function(a,b,e){try{if(c["default"].$("."+d.cardId).length){var h=!1,g=b.map(function(l){return l.contentId}).join(","),
k=b.filter(function(l){return""!==l.metadata.rankingStrategy}).map(function(l){return l.metadata.rankingStrategy}).join(","),m=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetRendered",intPayload:1,videoAsinList:g,rankingStrategy:k});v(m);q("cardWidgetRendered",1);m=function(l){l=d.buildCsmPayload({eventName:d.clientPrefix+":videoThumbnailImpression",intPayload:l,videoAsin:b[l].contentId,rankingStrategy:b[l].metadata.rankingStrategy});v(l)};var f=function(){for(var l=e.carouselItemClassName,
n=0;n<b.length;n++)if(!b[n].impressionRecorded){var t=c["default"].$("."+d.cardId+" ."+l+":nth-child("+(n+1)+")");if(c["default"].onScreen(t,0)){var G=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailImpression",intPayload:n,videoAsin:b[n].contentId,rankingStrategy:b[n].metadata.rankingStrategy});v(G);fb(t,b[n]);b[n].impressionRecorded=!0}else break}},p=function(){if(h)c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,p);else{var l=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetScrolledInView",
intPayload:1,videoAsinList:g,rankingStrategy:k}),n=c["default"].$("."+d.cardId+" ."+e.carouselItemClassName).first();n&&c["default"].onScreen(n,0)&&(v(l),l=c["default"].now()-a,q("cardWidgetScrolledInViewTime",l),F("cardWidgetScrolledInView"),h=!0,f())}};p();c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,p);c["default"].on("vse:"+d.clientPrefix+":searchform:focus",function(){var l=d.buildCsmPayload({eventName:d.clientPrefix+":serchFormFocus",intPayload:1,videoAsinList:g,rankingStrategy:k});
v(l)});e.widgetMetricsHandler(f,function(l){var n=d.buildCsmPayload({eventName:d.clientPrefix+":"+l+":paginationButtonClicked",intPayload:1});q(l+":paginationButtonClicked",1);v(n)});window.IntersectionObserver&&window.IntersectionObserverEntry&&new eb(null,"."+e.carouselItemClassName,m)}}catch(l){r("Error occurred while emitting widget metrics "+l,"ERROR"),q("widgetMetricsEmissionError")}},fb=function(a,b){try{var e=a.find("[data-pfoasin!=''][data-pfoasin]");c["default"].each(e,function(h,g){h=h.getAttribute("data-pfoasin");
g=d.buildCsmPayload({eventName:d.clientPrefix+":productElementImpression",intPayload:g,videoAsin:b.contentId,stringPayload:h});v(g)})}catch(h){r("Unable to log pfo render metric "+b,"WARN")}},gb=function(a,b){var e=[];a=a.split(",");0<a.length&&a.forEach(function(h){h=h.split(":");1<h.length&&e.push({name:h[0],assignment:h[1],ignoreForG2S2Key:b})});return e},hb=function(a,b){a="/gp/mobile/tag/?ref=vse_cards_ingress"+a+b.replace("/?_encoding=UTF8","");da(a,{},function(){},function(){})},ib=function(a,
b,e,h,g,k){void 0===k&&(k=!0);var m=a.map(function(f){delete f.htmlEl;return f});b||(b=wa(a[0],{}));a=[];e.weblabContext&&(a=gb(e.weblabContext,!0));da(e.nilgiriEndpoint,{requester:d.requester,clientPrefix:d.clientPrefix,page:d.pageType,placement:d.placement,device:d.deviceType,metadata:{id:"vse-video-widget-card-"+d.clientPrefix,celQueryStringParam:e.celQueryStringParam,requestHasVideoData:"true"},videoDataList:k?m:void 0,video:{contentID:b.contentId,contentIDType:"VIDEO_ID",videoURL:b.videoUrl,
imageURL:b.imageUrl,vendorCode:b.vendorCode,vendorTrackingId:b.vendorTrackingId,videoReferenceId:b.videoReferenceId,videoTitle:b.title,aciContentId:b.aciContentId,videoAge:b.videoAge},marketplaceID:e.marketplaceId,locale:e.locale,product:{contentID:b.productAsin,contentIDType:"ASIN",parentContentID:b.parentAsin,parentContentIDType:"ASIN"},creativeId:d.creativeId,weblabContext:a},h,g)},wa=function(a,b){var e=a.productAsin;e||c["default"].objectIsEmpty(a.metadata.relatedProductsAsins)||(e=a.metadata.relatedProductsAsins.split(",")[0]);
var h=a.contentId,g=a.metadata.title,k=a.metadata.vendorName,m=a.metadata.vendorCode,f=a.metadata.entityId,p=a.metadata.entityType,l=a.metadata.fullReviewLink,n=a.metadata.title,t=a.metadata.videoURL,G=a.metadata.formattedDuration,C=a.metadata.videoImageUrl,O=a.parentAsin,P="vse-cards-ingress"+a.index,Q=a.metadata.relatedProductsAsins,R=a.metadata.vendorTrackingId,S=a.metadata.referenceId,T=a.index,jb=a.metadata.videoAge,D=a.metadata.closedCaptions,xa=[];if(D&&(D=D.split(","),0===D.length%2))for(var U=
0;U<D.length;U+=2)void 0!==D[U+1]&&xa.push({locale:D[U],url:D[U+1]});b={contentId:h,title:g,vendorName:k,vendorCode:m,entityId:f,entityType:p,referenceUrl:l,referenceLinkTitle:n,videoUrl:t,duration:G,imageUrl:C,videoVoteContainer:{},productAsin:e,parentAsin:O,refTag:P,relatedProducts:Q,vendorTrackingId:R,videoReferenceId:S,index:T,$el:b,videoAge:jb,closedCaptions:xa,videoDetailPageLink:a.metadata.videoDetailPageLink,impressionRecorded:a.impressionRecorded,lastPlayingTimestamp:a.lastPlayingTimestamp,
htmlEl:a.htmlEl,rankingStrategy:a.metadata.rankingStrategy,aciContentId:a.metadata.aciContentId,videoMimeType:a.metadata.videoMimeType,profileLink:a.metadata.profileLink,profileImageUrl:a.metadata.profileImageUrl,source:""===a.metadata.source?"VSE":a.metadata.source,highlightedAsin:a.metadata.highlightedAsin,status:a.metadata.status,orientation:a.metadata.orientation,channelId:a.metadata.channelId};"true"===a.metadata.isSponsoredBrandVideo&&(h={adFeedbackUrl:a.metadata.adFeedbackUrl||"",clickTrackerUrl:a.metadata.clickTrackerUrl||
"",instrumentationPixelUrl:a.metadata.instrumentationPixelUrl||"",trackingPixelUrl:a.metadata.trackingPixelUrl||"",linkUrl:a.metadata.linkUrl||""},b=A.__assign(A.__assign({},b),{sponsoredBrandVideoMetadata:h,isSponsoredBrandVideo:a.metadata.isSponsoredBrandVideo}));return b},ea=function(a,b,e){var h=[];[].forEach.call(a,function(g,k){var m=g.dataset.asin,f=g.dataset;if(m){m={contentId:m,productAsin:f.productAsin||"",parentAsin:f.parentAsin||"",metadata:{videoImageUrl:f.videoImageUrlUnchanged||f.videoImageUrl||
"",videoURL:f.videoUrl||f.videoURL||"",title:f.title||"",formattedDuration:f.formattedDuration||"",vendorName:f.vendorName||"",vendorCode:f.vendorCode||"",referenceId:f.referenceId||"",fullReviewLink:f.referenceUrl||"",videoDetailPageLink:f.videoDetailPageLink||"vdp/"+m+b.celQueryStringParam,asin:f.asin||"",vendorTrackingId:f.vendorTrackingId||"",relatedProductsAsins:f.relatedProductsAsins||"",videoAge:f.videoAge||"",closedCaptions:f.closedCaptions||"",creatorType:f.creatorType||"",publicName:f.publicName||
"",profileLink:f.profileLink||"",profileImageUrl:f.profileImageUrl||"",rankingStrategy:f.rankingStrategy||"",aciContentId:f.csaCItemId||"",videoMimeType:f.videoMimeType||"",entityId:f.entityId||"",entityType:f.entityType||"",videoImageHeight:f.videoImageHeight||"",videoImageWidth:f.videoImageWidth||"",videoImagePhysicalId:f.videoImagePhysicalId||"",videoImageExtension:f.videoImageExtension||"",groupType:f.groupType||"",source:f.source||"",highlightedAsin:f.highlightedAsin||"",status:f.status||"",
orientation:f.orientation||"",channelId:f.channelId||""},impressionRecorded:!1,lastPlayingTimestamp:0,index:k,htmlEl:g};"true"===f.isSponsoredBrandVideo&&(g=g.querySelectorAll("."+e.vseSbVideoDataItem)[0])&&(g={adFeedbackUrl:g.dataset.adFeedbackUrl||"",clickTrackerUrl:g.dataset.clickTrackerUrl||"",instrumentationPixelUrl:g.dataset.instrumentationPixelUrl||"",trackingPixelUrl:g.dataset.trackingPixelUrl||"",linkUrl:g.dataset.linkUrl||"",isSponsoredBrandVideo:f.isSponsoredBrandVideo,videoDetailPageLink:f.vdpUrl||
""},m.metadata=A.__assign(A.__assign({},m.metadata),g));h.push(m);k=E["default"].cardRoot.getElementsByClassName(e.vseVideoDataItem)[k];try{f.profileLink&&f.profileImageUrl&&k&&ya(k,k.querySelector("."+e.vseProfilePlaceholder),e.vseVideoThumbnailProfile)}catch(p){r("Exception has occurred while initializing profiles. Exception details: "+p,"ERROR"),q("profileInitializationFailure",1)}try{""!==f.disclosureText&&""!==f.disclosureLink&&k&&ya(k,k.querySelector("."+e.vseVideoCreatorContainer),e.vseVideoDisclosure)}catch(p){r("Exception has occurred while moving the disclosure link. Exception details: "+
p,"ERROR"),q("moveDisclosureElementFailure",1)}}});return h},ya=function(a,b,e){a=a.querySelector("."+e);b&&a&&a.parentNode&&(b.appendChild(a.cloneNode(!0)),a.parentNode.removeChild(a),(b=b.querySelector("."+e))&&b.classList.remove("aok-hidden"))},za=function(a,b){void 0===b&&(b=!1);var e=B["default"].innerHeight*(400<=a.height()?.1:.2),h=B["default"].innerHeight-a.height()-e;if(b)try{var g=a[0].getBoundingClientRect();b=void 0;b=0<g.top?Math.min(a.outerHeight(),B["default"].innerHeight-g.top):Math.min(g.bottom,
B["default"].innerHeight);b=Math.max(0,b);var k=b>=.5*a.outerHeight()}catch(m){k=!1}else k=B["default"].scrollY+h>=a.offset().top&&B["default"].scrollY+e<=a.offset().top;return k},Y=function(){return B["default"].innerWidth>B["default"].innerHeight},w,Z=!1,Aa,fa,y,u,L,ha=!1,ia,V,M,z,H,I,J,aa=!1,Ba=!0,Ca=!1,ja,ka=0,ba,Da=null,pb=function(a,b,e,h,g,k,m,f){void 0===g&&(g=!1);void 0===k&&(k=!0);void 0===m&&(m=!1);void 0===f&&(f=void 0);return A.__awaiter(void 0,void 0,void 0,function(){var p,l,n;return A.__generator(this,
function(t){try{L=e;u=b;y=a;aa=g;Ba=k;Ca=m;p=c["default"].now();ua={schemaId:"vse.VSECardsEvents.7",producerId:"vsemetrics_widgetcards",requiredNumOfFields:13};I=E["default"].cardRoot.getElementsByClassName(u.vseVideoDataItem);if(!I)return q("noCardsIngressDom"),N(),[2];0<c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview").length&&(ba=c["default"].$(".vse-video-thumbnail-wrapper .vse-video-thumbnail-preview"),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,la),
la());if((l=E["default"].cardRoot.getElementsByClassName(u.vseWidgetPageState))&&l[0]&&l[0].dataset){H=l[0].dataset;w=ea(I,H,u);t=H;var G=f,C,O,P,Q;void 0===G&&(G="vse_cards");d.deviceType=y?"Mobile":"Desktop";d.pageType=t.client||"Gateway";d.clientName=null!==(C=t.clientName)&&void 0!==C?C:"";var R;(R=null===(O=t.clientPrefix)||void 0===O?void 0:O.toLowerCase())||(R="IVE_VFTP"==d.clientName?d.clientName.toLowerCase():d.pageType.toLowerCase());d.clientPrefix=R;d.placement=(""!==d.clientName?d.clientName:
d.pageType)+"Card-"+d.deviceType;d.metricsPlacement=(c["default"].capabilities.mobile?c["default"].capabilities.isAmazonApp?"mobile_app":"mobile_web":c["default"].capabilities.tablet?c["default"].capabilities.isAmazonApp?"tablet_app":"tablet_web":"desktop_web")+"."+d.placement+"."+G;d.cardId=null!==(P=t.cardId)&&void 0!==P?P:"";d.creativeId=null!==(Q=t.creativeId)&&void 0!==Q?Q:"";d.requester=t.requester||"VSEWidgetCards";ia="vse-component-feed-carousel-"+d.cardId;M="vse-widget-popover-"+d.cardId;
if(!c["default"].capabilities.video)return q("videoNotSupported"),[2];F("cardWidgetRendered");var S=w[0].productAsin?w[0].productAsin:"";d.buildCsmPayload=db({placementContext:d.metricsPlacement,clientId:"VSE",eventSource:"VSEWidgetCards",stringPayload:null!==S&&void 0!==S?S:"",creativeId:d.creativeId});if(y||"Detail"===d.pageType)va(p,w,h);else{c["default"].$("."+d.cardId+" [class*=vsePlaceholder] .a-fixed-right-grid-inner").addClass(u.vseNoRightPadding);C=p;try{Ea(C,h,"vse-carousel-items-added-"+
ia),Ea(C,h,"vse:cards:"+d.clientPrefix+":quad:ready")}catch(T){ma(T)}c["default"].trigger("vse-card-ready-"+ia)}(n=c["default"].capabilities.isAmazonApp&&c["default"].capabilities.android&&(c["default"].capabilities.androidVersion+"").startsWith("8"))?(q("useMshopAutoplayFallback"),N()):(kb(),lb(),mb(),nb(),ob());"gatewayquad"===d.clientPrefix&&c["default"].trigger("vse:cards:"+d.clientPrefix+":quad:ready");aa&&(Fa(null,c["default"].now()),Ga())}else q("pageStateNotFound"),N()}catch(T){r("fatal exception has occurred. Exception details: "+
T,"FATAL"),q("widgetFatalException"),N()}return[2]})})},Ea=function(a,b,e){c["default"].off(e);c["default"].on(e,function(){Z||(Z=!0,w=ea(I,H,u),va(a,w,b))})},lb=function(a){void 0===a&&(a="click touch");c["default"].declarative("vse-widget-carousel-see-more-"+d.cardId,a,function(){return Ha()});c["default"].declarative("vse-widget-carousel-custom-action-"+d.cardId,a,function(b){var e;(b=null===(e=b.data)||void 0===e?void 0:e.link)?(Ia("widgetCustomActionClicked"),ta["default"].setLocation(b)):Ha()})},
Ha=function(){y&&(ha=!0);c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").find(".vse-carousel-item").first().click();Ia("seeMoreLinkClicked")},Ia=function(a){F(a);a=d.buildCsmPayload({eventName:d.clientPrefix+":"+a,intPayload:1});v(a)},mb=function(){var a=0;c["default"].off("a:popover:afterShow:vse-widget-popover-"+d.cardId);c["default"].on("a:popover:afterShow:vse-widget-popover-"+d.cardId,function(b){try{if(c["default"].$(b.popover.$popover).addClass(c["default"].$("#"+M).data("cssClass")),
a++,fa=!0,1===a){c["default"].$(b.popover.$popover).addClass(u.vseVerticalLightbox);var e=c["default"].now();z&&z.refresh();aa?(c["default"].$(b.popover.$popover).addClass(u.vseRemoveAbsolute),na()):(Fa(b.popover.$popover,e),Ga())}else na()}catch(h){ma(h)}})},Fa=function(a,b){c["default"].on(d.clientPrefix+":vse:player:registered",function(){c["default"].$("#"+M+" [class*=_vseWidgetLbVideoBlock_]").first().animate({opacity:1});if(fa){na();c["default"].$(a).addClass(u.vseRemoveAbsolute);var e=c["default"].now()-
b;F("cardWidgetPopoverContentWaitTime",e)}});c["default"].on("vse:cards:"+d.clientPrefix+":componentbuilder:failed",function(){Ja();z?z.hide():c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:close");aa||c["default"].delay(function(){ta["default"].setLocation(J.videoDetailPageLink)},500)})},na=function(){ha&&c["default"].trigger("vse:"+d.clientPrefix+":page:watchAllClicked");ha=!1;var a={assetSpec:J,lightBoxId:""+M};!0===Ca&&Da!==J.contentId&&(Da=J.contentId,a.lazyLoadProductAsin=J.productAsin);
c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxOpened",a);a=c["default"].$("#"+M+" [class*=_vseWidgetLbVideoBlock_]");0<a.length&&(V=a.get(0),null!=L&&(qb(V),L.elect(V)))},nb=function(){c["default"].off("a:popover:beforeHide:vse-widget-popover-"+d.cardId);c["default"].on("a:popover:beforeHide:vse-widget-popover-"+d.cardId,function(){fa=!1;Aa?(c["default"].trigger("vse:"+d.clientPrefix+":page:lightBoxClosed"),null!=L&&V&&L.unsubscribe(V)):F("cardWidgetLBClosedBeforeAjax")})},Ga=function(){ib(w,
J,H,function(a){Aa=!0;q("preloadSuccess");c["default"].$("#"+M+" [class*=_vseWidgetLbVideoBlock_]").html(a.responseBody)},function(a){c["default"].trigger("vse:cards:"+d.clientPrefix+":componentbuilder:failed");F("preloadFailed");q("preloadFailed:"+a.statusCode);r("NilgiriService componentbuilder call has failed.\n        Status code: "+a.statusCode+". Status text: "+a.statusText,"FATAL");N()},Ba)},N=function(){var a=E["default"].cardRoot.getElementsByClassName(u.vseSeeMoreLink)[0];a&&a.classList&&
a.classList.add("aok-hidden")},kb=function(){try{[].forEach.call(I,function(a){a.children[0].removeAttribute("target")}),Ka(),c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").delegate(".vse-carousel-item","click",function(a){Z||(w=ea(I,H,u),Z=!0);if(!c["default"].$(a.target).closest("."+u.vseProfilePlaceholder).length){a.preventDefault();var b=c["default"].$(a.currentTarget);a=b.closest("li").index();var e=w[a];e.metadata&&(J=wa(e,b),b=d.buildCsmPayload({eventName:d.clientPrefix+":cardWidgetClicked",
intPayload:1,videoAsin:e.contentId,rankingStrategy:e.metadata.rankingStrategy}),F("cardWidgetClicked"),v(b),hb(a,H.celQueryStringParam),y?c["default"].trigger("vse:cards:"+d.cardId+":secondary:view:open"):(z=ab["default"].get(c["default"].$("."+d.cardId+" #vse-widget-popover-trigger")),c["default"].objectIsEmpty(z)?q("lbNotFoundDesktop"):z.show()))}})}catch(a){ma(a)}},ma=function(a){r("fatal exception has occurred in LB. Exception details: "+a,"FATAL");q("lightboxOpenFatalException");N();Ja();z&&
z.hide()},Ja=function(){Ka();[].forEach.call(I,function(a,b){a.children&&a.children[0]&&a.children[0].setAttribute("target",w[b].metadata.videoDetailPageLink)})},Ka=function(){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel").undelegate(".vse-carousel-item","click")},qb=function(a){L.subscribe(a,function(b){},{buffer:0})},ob=function(){c["default"].on(d.clientPrefix+"-leave-pip",function(a){c["default"].$("."+d.cardId+" .vse-cards-ingress-carousel .vse-carousel-item")[a.index].click()})},
La=function(a,b){ja[b]||(a=d.buildCsmPayload({eventName:d.clientPrefix+":thumbnailPreviewPlaybackStart",intPayload:b,videoAsin:a}),void 0!==a&&null!==a&&(v(a),ja[b]=!0))},la=function(){c["default"].onScreen(c["default"].$(".vse-video-thumbnail-wrapper"),100)&&(c["default"].each(ba,function(a){var b=a.getAttribute("data-src");var e=void 0;void 0===e&&(e=1);e=3*(e-1);b=b.split(",")[e];a.src=b;a.addEventListener("ended",rb)}),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,la),ja=Array(ba.length).fill(!1),
y||sb(),tb(),c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,W),W())},sb=function(){c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card","mouseenter",function(){ca();var a=c["default"].$(this).find("video"),b=c["default"].$(this).find(".vse-video-thumbnail-img");Ma(b);0<a.length&&(a[0].play(),b=c["default"].$(this).closest("li").index(),La(a[0].getAttribute("data-video-asin"),b),ka=0)});c["default"].$(".vse-video-widget-container").delegate(".vse-desktop-carousel-card",
"mouseleave",function(){var a=c["default"].$(this).find(".vse-video-thumbnail-img");oa(a);a=c["default"].$(this).find("video");0<a.length&&pa(a[0])})},oa=function(a){a&&0<a.length&&c["default"].fadeIn(a,300,"ease-in")},Ma=function(a){a&&0<a.length&&c["default"].fadeOut(a,300,"ease-in")},Na=function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||0!=a.length)return c["default"].$(a).find("video")[0]},Oa=function(a){a=c["default"].$(".vse-video-widget-container ol li").eq(a);if(!a||
0!=a.length)return c["default"].$(a).find(".vse-video-thumbnail-img")},ra=function(a){var b=Na(a);if(b){var e=Oa(a);Ma(e);b.play().then().catch(function(){c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,W);c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,qa);ca(!0)});ka=a;La(b.getAttribute("data-video-asin"),a)}},W=function(){var a=c["default"].$(".vse-video-widget-container");if(0<a.length&&(!Y()&&c["default"].onScreen(a)&&za(a)||Y()&&c["default"].onScreen(a))){c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,
W);c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,qa);a=y?Pa():ka;var b=Na(a);if(!b||b.paused)ca(),ra(a)}},qa=function(){var a=c["default"].$(".vse-video-widget-container");0!=a.length&&(!za(a)&&!Y()||Y()&&!c["default"].onScreen(a))&&(c["default"].on(c["default"].constants.BROWSER_EVENTS.SCROLL,W),c["default"].off(c["default"].constants.BROWSER_EVENTS.SCROLL,qa))},ca=function(a){void 0===a&&(a=!1);c["default"].each(ba,function(b){if(0!==b.currentTime||a){var e=c["default"].$(b).closest(".vse-video-thumbnail-wrapper").find(".vse-video-thumbnail-img");
oa(e);pa(b)}})},pa=function(a){setTimeout(function(){a.currentTime=0;a.load()},300)},Pa=function(){var a=0;try{var b=c["default"].$(".vse-video-widget-container"),e=parseInt(b.find("li").css("width").replace("px",""))+8,h=b.find("ol").css("-webkit-transform").split(/[()]/)[1],g=Math.abs(parseInt(h.split(",")[4]));a=Math.round(g/e)}catch(k){r("Error has occurred while finding the current focussed Element. Exception details: "+k,"ERROR")}return a},rb=function(a){try{var b=a.target.closest("li");pa(a.target);
var e=c["default"].$(b).index()+1;a=0;try{var h=c["default"].$(".vse-video-widget-container"),g=parseInt(h.find("li").css("width").replace("px","")),k=y?c["default"].$(window).width():c["default"].$(".vse-video-widget-container .a-carousel-viewport").width();a=Math.floor(k/(g+8))}catch(n){r("Error has occurred while finding the no of Thumbnails on screen. Exception details: "+n,"ERROR")}var m=a;var f=Math.ceil(e/m),p=Math.ceil((e+1)/m),l=Oa(e-1);oa(l);f===p&&ra(e)}catch(n){r("Error has occurred while playing the next preview. Exception details: "+
n,"ERROR")}},tb=function(){var a=c["default"].$(".vse-cards-carousel-container");cb["default"].getCarousel(a).on("change:pageNumber",function(){ca();setTimeout(function(){ra(Pa())},y?100:310)})},ub=function(a){var b=c["default"].capabilities.mobile;return{carouselItemClassName:a.carouselElement,widgetMetricsHandler:function(e,h){var g=c["default"].throttle(function(){e()},500,{leading:!1});c["default"].on(c["default"].constants.BROWSER_EVENTS.RESIZE,function(){e()});c["default"].$("."+d.cardId+" .a-carousel-goto-prevpage").click(function(){h("left");
g()});c["default"].$("."+d.cardId+" .a-carousel-goto-nextpage").click(function(){h("right");g()});b&&(c["default"].off("a:carousel:vse-cards-vw-dp:change:pageNumber"),c["default"].on("a:carousel:vse-cards-vw-dp:change:pageNumber",g))}}},K={thumbnailUpdates:"_vse-vw-dp-card_style_thumbnailUpdates__3sx2a",vseVideoImageWrapper:"_vse-vw-dp-card_style_vseVideoImageWrapper__3Sk54",vseCarouselItem:"_vse-vw-dp-card_style_vseCarouselItem__3IvFU",vseCarouselItemHovering:"_vse-vw-dp-card_style_vseCarouselItemHovering__3nydI",
vseHoverSection:"_vse-vw-dp-card_style_vseHoverSection__1n4YC",carouselElement:"_vse-vw-dp-card_style_carouselElement__AVBU9",vseMobileVideoWidget:"_vse-vw-dp-card_style_vseMobileVideoWidget__17sDD",vseDesktopCarousel:"_vse-vw-dp-card_style_vseDesktopCarousel__1UwLK",vseVideoDuration:"_vse-vw-dp-card_style_vseVideoDuration__vDK4S",vseVideoTitle:"_vse-vw-dp-card_style_vseVideoTitle__sPgV5",vseVideoTitleBlockOverlay:"_vse-vw-dp-card_style_vseVideoTitleBlockOverlay__ZyhF4",vseThumbnailSecondaryImg:"_vse-vw-dp-card_style_vseThumbnailSecondaryImg__2eoNE",
vseVideoTitleBlock:"_vse-vw-dp-card_style_vseVideoTitleBlock__Qp7Od",vseVideoTitleText:"_vse-vw-dp-card_style_vseVideoTitleText__1lJWI",vseVideoTitleWithCreator:"_vse-vw-dp-card_style_vseVideoTitleWithCreator__1Meqf",vseHasProfile:"_vse-vw-dp-card_style_vseHasProfile__28XGY",vseVideoCreatorName:"_vse-vw-dp-card_style_vseVideoCreatorName__3M1B_",vseProfilePlaceholder:"_vse-vw-dp-card_style_vseProfilePlaceholder__34FkJ",vseVideoThumbnailProfile:"_vse-vw-dp-card_style_vseVideoThumbnailProfile__1TFKR",
vseLazyLoadSpinner:"_vse-vw-dp-card_style_vseLazyLoadSpinner__2XtFC",vseVideoSegmentHeader:"_vse-vw-dp-card_style_vseVideoSegmentHeader__14ouc",vseFirstItem:"_vse-vw-dp-card_style_vseFirstItem__3h4BK",vseVideoWidgetHeaderBlock:"_vse-vw-dp-card_style_vseVideoWidgetHeaderBlock__2t4B0",vseVideoWidgetHeader:"_vse-vw-dp-card_style_vseVideoWidgetHeader__30B2I",vseWidgetPageState:"_vse-vw-dp-card_style_vseWidgetPageState__2eblq",vseVideoWidgetContainer:"_vse-vw-dp-card_style_vseVideoWidgetContainer__3HDIT",
vseIngressCarousel:"_vse-vw-dp-card_style_vseIngressCarousel__2Knkb",vseThumbnailPreviewImg:"_vse-vw-dp-card_style_vseThumbnailPreviewImg__3dlho",vseCardsVideoThumbnail:"_vse-vw-dp-card_style_vseCardsVideoThumbnail__3xlzJ",vseWidgetLbVideoBlock:"_vse-vw-dp-card_style_vseWidgetLbVideoBlock__VfqBF",vseWidgetLbVideoBlockWrapper:"_vse-vw-dp-card_style_vseWidgetLbVideoBlockWrapper__v6yOr",vseWidgetLbAbsolute:"_vse-vw-dp-card_style_vseWidgetLbAbsolute__bgBq7",vseWidgetLbSpinner:"_vse-vw-dp-card_style_vseWidgetLbSpinner__yjdTV",
vseVerticalLightbox:"_vse-vw-dp-card_style_vseVerticalLightbox__12YT2",vseRemoveAbsolute:"_vse-vw-dp-card_style_vseRemoveAbsolute__2xmeK",vseUploadButton:"_vse-vw-dp-card_style_vseUploadButton__5QCM8",vseUploadButtonIcon:"_vse-vw-dp-card_style_vseUploadButtonIcon__2-eZR",vseVideoDataItem:"_vse-vw-dp-card_style_vseVideoDataItem__2A7tm",vseVwdpWidgetPageState:"_vse-vw-dp-card_style_vseVwdpWidgetPageState__283lp",vseSbVideoDataItem:"_vse-vw-dp-card_style_vseSbVideoDataItem__1TmVd",thumbnailPreviewWrap:"_vse-vw-dp-card_style_thumbnailPreviewWrap__2sqTc",
vseSearchVideosInput:"_vse-vw-dp-card_style_vseSearchVideosInput__2CfoS",videoPreviewWrapper:"_vse-vw-dp-card_style_videoPreviewWrapper__vvNVU",clearSearchInput:"_vse-vw-dp-card_style_clearSearchInput__3ZK67",sponsoredVideoLabel:"_vse-vw-dp-card_style_sponsoredVideoLabel__23SsR"};sa._operationNames=[];sa.card=function(){return A.__awaiter(void 0,void 0,void 0,function(){var a,b,e,h,g,k,m,f,p;return A.__generator(this,function(l){switch(l.label){case 0:X.count("vse-vw-dp-card:rendered",1);a=[".vse-segment-title-RVS_G1",
".vse-segment-title-RVS_G2",".vse-segment-title-RVS_G1_T1",".vse-segment-title-RVS_G2_T1"];a.forEach(function(n){c["default"].$(".vse-video-widget-dp-container ."+K.vseVideoDataItem).find(""+n).first().addClass(K.vseFirstItem)});b=c["default"].capabilities.mobile;e=ub(K);if(c["default"].capabilities.mobile&&c["default"].capabilities.isAmazonApp&&(h=E["default"].cardRoot.getElementsByClassName(K.vseVwdpWidgetPageState))&&h[0]&&h[0].dataset){g=h[0].dataset.searchAllVideosTreatment||"C";try{Za["default"].trigger("VSE_VWDP_SEARCHBAR_571449",
g),"T1"===g&&(c["default"].$("."+K.vseSearchVideosInput).removeClass("aok-hidden"),k=E["default"].cardRoot.getElementsByTagName("form")[0],m=k.getElementsByTagName("input")[0],m.addEventListener("focus",function(){c["default"].trigger("vse:detail:searchform:focus")}),f=E["default"].cardRoot.getElementsByClassName(K.clearSearchInput)[0],p=function(){""!==m.value?f.classList.remove("aok-hidden"):f.classList.add("aok-hidden")},m.addEventListener("keyup",p),p(),f.addEventListener("click",function(){m.value=
"";p();m.focus()}))}catch(n){r("Issue with VWDP Search form: "+n,"ERROR")}}return[4,pb(b,K,null,e,!0,!0)];case 1:return l.sent(),[2]}})})}});
